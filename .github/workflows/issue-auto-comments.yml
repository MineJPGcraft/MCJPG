name: Issue and PR Auto Comment

on:
  issues:
    types:
      - opened
      - closed
  pull_request_target:
    types:
      - opened
      - closed

permissions:
  contents: read

jobs:
  auto-comment:
    permissions:
      issues: write
      pull-requests: write
    runs-on: ubuntu-latest
    steps:
      # Issue å¼€å¯æ—¶çš„è‡ªåŠ¨å›å¤
      - name: Auto Comment on Issues Opened
        if: github.event_name == 'issues' && github.event.action == 'opened'
        uses: wow-actions/auto-comment@v1
        with:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          issuesOpened: |
            ğŸ‘‹ ä½ å¥½ @{{ author }},æ„Ÿè°¢æäº¤ Issue!
            ğŸ‘‹ Hello @{{ author }}, thanks for submitting the issue!
            
            æˆ‘ä»¬ä¼šå°½å¿«æŸ¥çœ‹å¹¶å›å¤ã€‚å¦‚æœæ‚¨çš„é—®é¢˜ç´§æ€¥,è¯·åœ¨ Issue ä¸­è¯´æ˜ã€‚
            We will review and respond as soon as possible. If your issue is urgent, please indicate it in the issue.

      # Issue å…³é—­æ—¶çš„è‡ªåŠ¨å›å¤
      - name: Auto Comment on Issues Closed
        if: github.event_name == 'issues' && github.event.action == 'closed'
        uses: wow-actions/auto-comment@v1
        with:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          issuesClosed: |
            âœ… @{{ author }}
            æ­¤ Issue å·²è¢«å…³é—­,å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜,å¯ä»¥ç»§ç»­å›å¤ã€‚
            This issue is closed. If you have any questions, you can comment and reply.

      # å†…éƒ¨ PR å¼€å¯æ—¶çš„è‡ªåŠ¨å›å¤
      - name: Auto Comment on Internal PR Opened
        if: |
          github.event_name == 'pull_request_target' && 
          github.event.action == 'opened' &&
          github.event.pull_request.head.repo.full_name == github.repository
        uses: wow-actions/auto-comment@v1
        with:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          pullRequestOpened: |
            ğŸ‰ æ„Ÿè°¢ @{{ author }} æäº¤ Pull Request!
            ğŸ‰ Thanks @{{ author }} for submitting the Pull Request!
            
            æˆ‘ä»¬ä¼šå°½å¿«å®¡æŸ¥æ‚¨çš„ä»£ç ã€‚åœ¨æ­¤æœŸé—´,è¯·ç¡®ä¿:
            We will review your code as soon as possible. In the meantime, please ensure:
            - âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ / All tests pass
            - âœ… ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ / Code follows project conventions
            - âœ… å·²æ·»åŠ å¿…è¦çš„æ–‡æ¡£ / Necessary documentation is added
            
            ğŸ¤– æˆ‘ä»¬çš„ **MCJPG Agent** å°†è‡ªåŠ¨å¯¹æ‚¨çš„ä»£ç è¿›è¡Œåˆæ­¥å®¡æŸ¥ã€‚
            ğŸ¤– Our **MCJPG Agent** will automatically conduct an initial review of your code.
            
            å¦‚æœ‰ä»£ç è¾…åŠ©éœ€æ±‚,è¯·åœ¨è¯„è®ºåŒº `@claude` è¿›è¡Œè¯·æ±‚ã€‚
            If you need code assistance, please `@claude` in the comments.

      # å¤–éƒ¨ PR å¼€å¯æ—¶çš„è‡ªåŠ¨å›å¤
      - name: Auto Comment on External PR Opened
        if: |
          github.event_name == 'pull_request_target' && 
          github.event.action == 'opened' &&
          github.event.pull_request.head.repo.full_name != github.repository
        uses: wow-actions/auto-comment@v1
        with:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          pullRequestOpened: |
            ğŸ‰ æ„Ÿè°¢ @{{ author }} æäº¤ Pull Request!
            ğŸ‰ Thanks @{{ author }} for submitting the Pull Request!
            
            æˆ‘ä»¬ä¼šå°½å¿«å®¡æŸ¥æ‚¨çš„ä»£ç ã€‚åœ¨æ­¤æœŸé—´,è¯·ç¡®ä¿:
            We will review your code as soon as possible. In the meantime, please ensure:
            - âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ / All tests pass
            - âœ… ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ / Code follows project conventions
            - âœ… å·²æ·»åŠ å¿…è¦çš„æ–‡æ¡£ / Necessary documentation is added
            
            ---
            
            ğŸ¤– **è‡ªåŠ¨ä»£ç å®¡æŸ¥çŠ¶æ€**: ç­‰å¾…æ‰¹å‡†
            ğŸ¤– **Automated Code Review Status**: Pending Approval
            
            ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¥è‡ªå¤–éƒ¨ä»“åº“çš„ Pull Request,æˆ‘ä»¬çš„ Claude AI ä»£ç å®¡æŸ¥éœ€è¦ç»´æŠ¤è€…æ‰‹åŠ¨æ‰¹å‡†åæ‰èƒ½è¿è¡Œã€‚è¿™æ˜¯ä¸ºäº†:
            Since this is a Pull Request from an external repository, our Claude AI code review requires manual approval from a maintainer before it can run. This is to:
            - ğŸ›¡ï¸ ä¿æŠ¤ä»“åº“å®‰å…¨ / Protect repository security
            - ğŸ’° é˜²æ­¢ API é…é¢æ»¥ç”¨ / Prevent API quota abuse
            - âœ… ç¡®ä¿å®¡æŸ¥è´¨é‡ / Ensure review quality
            
            â³ ç»´æŠ¤è€…å°†å°½å¿«å®¡æ ¸æ‚¨çš„ PR å¹¶æ‰¹å‡†è‡ªåŠ¨å®¡æŸ¥,è¯·è€å¿ƒç­‰å¾…ã€‚
            â³ A maintainer will review your PR and approve the automated review shortly. Thank you for your patience!
            
            å¦‚æœ‰ä»£ç è¾…åŠ©éœ€æ±‚,è¯·åœ¨è¯„è®ºåŒº `@claude` è¿›è¡Œè¯·æ±‚ã€‚
            If you need code assistance, please `@claude` in the comments.

      # PR åˆå¹¶æ—¶çš„è‡ªåŠ¨å›å¤
      - name: Auto Comment on Pull Request Merged
        if: |
          github.event_name == 'pull_request_target' && 
          github.event.pull_request.merged == true
        uses: actions-cool/pr-welcome@main
        with:
          token: ${{ secrets.GH_TOKEN }}
          comment: |
            â¤ï¸ æ„Ÿè°¢æ¥è‡ª @${{ github.event.pull_request.user.login }} çš„ PR â¤ï¸
            â¤ï¸ Great PR from @${{ github.event.pull_request.user.login }} â¤ï¸
            
            å¦‚æœæ‚¨ä¹Ÿå¯¹ **MCJPG** ç»„ç»‡çš„å¼€å‘å·¥ä½œæ„Ÿå…´è¶£,æ¬¢è¿è”ç³»å¹¶åŠ å…¥æˆ‘ä»¬!
            If you're also interested in the development work of the **MCJPG** organization, feel free to reach out and join us!
          emoji: 'hooray'
          pr-emoji: '+1, heart'
